
# Stage 1: Build Image

FROM ubuntu:latest AS BUILD_IMAGE
 
# Update package lists and install necessary tools

RUN apt update && apt install wget unzip -y
 
# Download a zip file containing the template

RUN wget https://www.tooplate.com/zip-templates/2128_tween_agency.zip
 
# Unzip the template, create a tarball, and move it to /root/tween.tgz

RUN unzip 2128_tween_agency.zip && \

    cd 2128_tween_agency && \

    tar -czf tween.tgz * && \

    mv tween.tgz /root/tween.tgz
 
# Stage 2: Final Image

FROM ubuntu:latest
 
# Install Apache, Git, and wget

RUN apt update && apt install apache2 git wget -y
 
# Copy the tarball from the BUILD_IMAGE stage to /var/www/html in the final image

COPY --from=BUILD_IMAGE /root/tween.tgz /var/www/html
 
# Extract the contents of the tarball

RUN cd /var/www/html/ && tar xzf tween.tgz
 
# Set the default command to start Apache in the foreground

CMD ["/usr/sbin/apache2ctl", "-D", "FOREGROUND"]
 
# Define a volume for Apache logs, set the working directory to /var/www/html

VOLUME /var/log/apache2

WORKDIR /var/www/html/
 
# Expose port 80 for incoming web traffic

EXPOSE 80